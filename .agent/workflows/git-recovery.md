---
description: Gitリポジトリの不整合（追跡情報の消失・歴史の分岐）を修復する手順
---

# Gitリポジトリ修復ワークフロー

強制プッシュや予期せぬブランチ操作により、ローカルブランチのリモート追跡情報（upstream）が失われたり、歴史が分岐して `git pull` 等ができなくなった場合の修復手順です。

## ステップ 1: 現状の確認
まず、ブランチの状態と追跡設定の詳細を確認します。

```bash
# 全てのブランチ（リモート含む）を表示
git branch -a

# 各ブランチの追跡情報と最新コミットを表示
git branch -vv
```

## ステップ 2: リモート追跡設定（Upstream）の修復
「No remote for the current branch」と出る場合は、ローカルブランチがどこのリモートを見るべきか設定し直します。

```bash
# mainブランチを origin/main に紐付ける場合
git branch --set-upstream-to=origin/main main
```

## ステップ 3: リモートの最新状態との同期
歴史が分岐している（ahead/behind 両方ある）場合は、リモートの歴史をベースに自身の変更を載せ直す rebase が有効です。

```bash
git pull --rebase origin main
```

## ステップ 4: 不要なローカルブランチの削除
誤ってリモート名（`origin` など）と同じ名前のローカルブランチを作成してしまった場合は削除します。

```bash
git branch -d [ブランチ名]
```

## 注意事項: 予防策
- `main` ブランチへの強制プッシュ (`push -f`) は、他の作業者のリポジトリを破壊する可能性があるため極力避ける。
- 歴史を修正した後は、必ず `git status` で不整合がないか確認する。
