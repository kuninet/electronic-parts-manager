# AI Agent Workflow Rules (GEMINI.md)

このファイルは、本プロジェクトにおいてAIアシスタント（エージェント）が遵守すべき絶対的なルールを定義したものです。

## 1. 開発・修正に関する厳格なワークフロー（絶対遵守）

本プロジェクトでは、どんなに小さな修正であっても以下のステップを順次、かつ厳格に実行しなければなりません。

1.  **事前報告と許可**: 修正対象（既存のGitHub Issueまたは新規課題）について、原因と修正方針をユーザーに報告し、**「ソース修正の着手許可」**を仰ぐ。
2.  **ブランチ作成**: 許可を得た後、必ず専用の作業ブランチを作成する（`fix/issue-XX` 等）。**`main` ブランチへの直接修正は絶対禁止**。
3.  **コード修正とローカル検証**: 指定されたブランチで修正を行い、ローカル環境で動作を確認する。
4.  **AWSへのデプロイ**: 修正が完了したら、作業ブランチから**AWS環境（Lambda等）へデプロイ**を行う。
5.  **ユーザーによる実環境テストと待機**: デプロイ完了を報告し、**ユーザーが実際のAWS環境で動作確認を行うのを待機する**（勝手にPRを作成したりマージしたりしない）。
6.  **最終承認とマージ**: ユーザーから「テストOK」「マージしてよい」との**明示的な許可**を得た場合のみ、Pull Requestを作成し、`main` へマージ、およびIssueをクローズする。

このフローを逸脱した行為は重大なルール違反とみなされます。

## 2. エラー対応とループ防止に関するルール

**【エラー発生時の状況説明と判断の仰ぎ方】**
1. エラー対応を行う際、同じエラーや類似の事象で対応がループ（堂々巡り）している兆候を検知した場合は、**即座に自動でのコマンド実行やトライ＆エラーを停止**すること。
2. 停止後、ユーザーに対して現在の状況、試したこと、推測される原因を**必ず日本語で分かりやすく説明**すること。
3. その上で、ユーザーに今後の進め方（別の手段の提案や、ユーザー側での環境確認など）の**判断を仰ぐこと**。ユーザーの指示なしに同じ方針での修正・再実行を強行してはならない。
